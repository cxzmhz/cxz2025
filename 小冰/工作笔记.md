## 员工平台

https://dev.azure.com/xiaobingai/AICreation/_git/AvatarFrontEnd?path=/private/AIDigitalEmployees

https://aibeings-vip-int.xiaoice.com/

## 渠道平台

https://dev.azure.com/xiaobingai/AICreation/_git/UserExperience?path=/private/ChannelOperation

https://aibeing-enterprise-center-int.xiaoice.com/

## 运营平台

https://dev.azure.com/xiaobingai/AICreation/_git/AvatarFrontEnd?path=/private/VHOperationPlatform

https://operation-int.xiaoice.com

## 账号中心

https://dev.azure.com/xiaobingai/AICreation/_git/AvatarFrontEnd?path=/private/PublicAccount

https://aibeing-account-int.xiaoice.com/

## AgentX

https://dev.azure.com/xiaobingai/AICreation/_git/AvatarFrontEnd?path=/private/AiAgent

https://aibeings-agent-int.xiaoice.com/

## AgentXFlow

https://dev.azure.com/xiaobingai/AICreation/_git/AvatarFrontEnd?path=/private/AiAgentWorkflow

https://aibeings-agent-int.xiaoice.com/workflow-builder/app/37d363ec-cdb2-4f62-b412-736133c0ea89/workflow

## 发版流程

1. master 切 feature 分支开发
2. 开发完成，推代码，pr 到 int 分支提测，如果有冲突，本地拉临时分支 fixconflict，fixconflict->int，合完删除临时分支，如果冲突较多，且 int 暂无其他人提测，可以才用删除 int 分支，从 master 重新切一个干净的 int 分支，然后再 feature->int
3. int 测试完成，feature->master
4. master=>prod
5. staging 环境让产品复测一遍，没问题再切 prod 分支，此时 staging 会回退到上一个版本，如果 prod 出现无法定位的问题，可以找运维帮忙回滚
6. 切记，pipeline 发版最好不要过夜切 prod，staging 禁止两个 pipeline 同时进行
7. 私有化的包授权流程参考 https://dev.azure.com/xiaobingai/AICreation/_artifacts/feed/npm-registry/connect mac 可以使用文档里的 other 方式
8. 注意始终不要将部署分支 pr 到开发分支
9. 分支删除只能找创建分支的人或者高权限的人或者运维帮忙删除
10. pr 进 master 使用 squash commit
11. pr 进 int 使用 merge commit
12. pr 规定需要至少两人 approve

## 私有包地址

1. 本地 https://pkgs.dev.azure.com/aibeings/_packaging/xiaoice-npm/npm/registry/
2. 线上 https://dev.azure.com/aibeings/aibeings/_artifacts/feed/xiaoice-npm@Local/connect

## 注意事项

1. ChannelOperation 用 yarn
2. Aiagent 不用管 .npmrc 用 18 去跑
3. VHOPERATIONPLATFORM 也是一样
4. AIDigitalEmployees 用 yarn 管理，用 node16 去跑

- tsconfig.json 配置里面的 project 要不要改成这种绝对路径的方式

```js
parserOptions: {
  project: require('path').join(__dirname, './tsconfig.json')
},
```

- .npmrc 里面的 registry 要不要改成`@ice-components:registry`的方式来限定 scope

- 记得连接 vpn

- vsts-npm-auth
  `vsts-npm-auth -config .npmrc`

## 私有仓库授权

1. 先将.npmrc 里面的 registry 改成`https://pkgs.dev.azure.com/aibeings/_packaging/xiaoice-npm/npm/registry/`

2. 将 yarn.lock 或 package-lock.json 里面的使用旧的 registry 的包全部替换成上面这个新的 registry

3. 控制台切换到当前项目目录，执行`vsts-npm-auth -config .npmrc`

4. 运行`yarn install`或`npm install`安装依赖
